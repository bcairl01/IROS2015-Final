%%% Introduction %%%

Legged robotic systems have long employed motion controllers based on limit cycle oscillators and, more recently, Central Pattern Generators (CPGs)  for the purpose of generating bio-mimetic gaits \cite{Matsuoka1985,Collins1993,Endo2004,Righetti2006,Ijspeert2008,Matos2010,Ajallooeian2013,Park2014,Fukuoka2015}. Since these motion control methods are open-loop motion planners (\IE not inherently formulated to incorporate feedback) they often require the use of auxiliary control mechanisms to ensure gait stability. Namely, the zero-moment point and center of gravity of a legged system are often considered when designing controllers to stabilize oscillator-driven gaits, as summarized in \cite{Wieber2015}. %add ZMP references%

Developments in CPG-based gait controllers have led to the incorporation of ``reflexive" feedback mechanisms aimed at correcting foot-placement during gaiting on uneven terrain or various surfaces. One such approach involves active compliance to each leg by directly modifying CPG oscillators via feedback-driven modulations. In \cite{Endo2004} and \cite{Fukuoka2003}, CPG oscillators are modified by a using a single tuning parameter.

In this paper, we consider disturbance rejection of a multi-legged platform and achieving constant, level orientation of the trunk (\IE a stable platform), although other orientations could be considered. 
	\begin{figure}[t!]
		\vspace{2mm}
		\centering
		\SetImage{0.375}{tipping_robot.png}
%		\begin{subfigure}{0.475\textwidth}
%			\centering
%			\SetImage{\ImageWidthRatioSub}{tipping_robot.png}
%			\caption{ }
%		\end{subfigure}
%		\begin{subfigure}{0.475\textwidth}
%			\centering
%			\SetImage{\ImageWidthRatioSub}{gait_sequence.png}
%			\caption{ }
%		\end{subfigure}
%		\caption{ \textbf{a)} Quadruped tipping about planted feet; \textbf{b)} Trot-gait sequence being executed by robot in \textbf{(a)}.}
		\caption{ Quadruped tipping about planted feet.}
		\label{fig::quadruped_walking}
		\vspace{-7mm}
	\end{figure}
Disturbance rejection from the trunk sub-system of a legged platform has practical significance when carrying a payload (such as cameras, optical systems, armaments, etc.) rigidly fixed to the main body of the robot. Disturbances are imparted upon the trunk during gaiting in two main ways: 1) instantaneous changes in force distribution when feet make and break contact with the ground, and 2) under-actuation that occurs during certain dynamic gaits. During dynamic trot gaits, for example, the state of contact between the feet and the ground is changed often so as to prevent the walking robot from tipping past a recoverable configuration. These gaits feature the utilization of two or fewer legs to support the trunk at any given time, causing the system to enter an under-actuated mode where the body is free to rock about the planted feet, as shown in Figure \ref{fig::quadruped_walking}.

To achieve disturbance rejection on the trunk orientation and attain a fixed orientation, the proposed control methodology utilizes a Nonlinear Autoregressive Neural Network with Exogenous inputs (NARX-NN) as part of an active compensation mechanism. The network is used to estimate the system dynamics and, further, predict periodic disturbances in an on-line fashion. To present how the NARX-NN based controller is formulated, we will first examine the general-form dynamics of a quadruped system. Next, the NARX-NN compensator mechanism will be outlined along with an associated NARX-NN training regimen formulated with respect to the system dynamics. The compensator will then be formulated for use with a legged system implemented with a decentralized joint control architecture. Here, the compensator will be utilized to modify referential joint trajectories by way of a weighted sum between the original joint trajectories generated by a seperate gaiting mechanism and a reference correction signal generated by the compensator.

The effectiveness of the proposed methodology will be shown through extensive simulation studies on a quadruped robot modeled after our in-house developed quadruped system (the BlueFoot Quadruped) during a CPG-driven trot gait. Results will highlight the robustness of the compensator during gaits at various speeds. We also include results which depict the effect various of mixtures between the original CPG reference and NARX-NN compensator output signals. Lastly, some final remarks will be made about possible directions for enhancing the design of the compensator.