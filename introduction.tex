%%% Introduction %%%

Legged robotic systems have long employed motion controllers based on limit cycle oscillators and, more recently, Central Pattern Generators (CPGs)  for the purpose of generating bio-mimetic gaits \cite{Matsuoka1985,Collins1993,Endo2004,Righetti2006,Ijspeert2008,Matos2010,Ajallooeian2013,Park2014,Fukuoka2015}. Since these motion control methods are open-loop motion planners (\IE not inherently formulated to incorporate feedback) they do not perform any active system stabilization on their own. As a result, implementations involving these locomotion methods often require auxiliary control mechanisms which provide gait stability. Considerations of a system's zero-moment point and center of gravity are often utilized in the design of stable oscillator driven gaits. Methods which employ these values toward gait stabilization are summarized in \cite{Wieber2015}. %add ZMP references%

Developments in CPG-based gait controllers have led to the incorporation of ``reflexive" feedback mechanisms aimed at correcting foot-placement during gaiting on uneven terrain or various surfaces. One such approach involves active compliance to each leg by directly modifying CPG oscillators units through feedback-driven modulations. In  \cite{Fukuoka2003} and \cite{Endo2004}, a CPG for each leg is modified by a neural oscillator with one tuning parameter.  

%Provided a stable gait designed utilizing results from the aforementioned studies, we consider an additional
%system requirement that the robot's trunk remain level during the execution of an oscillator-generated gait. 

In this paper, we consider disturbance rejection of a multi-legged platform and achieving constant, level orientation of the trunk (\IE a stable platform), although other orientations could be considered. 
	\begin{figure}[b!]
	\centering
		\begin{subfigure}{0.475\textwidth}
			\centering
			\SetImage{\ImageWidthRatioSub}{tipping_robot.png}
			\caption{ }
		\end{subfigure}
		\begin{subfigure}{0.475\textwidth}
			\centering
			\SetImage{\ImageWidthRatioSub}{gait_sequence.png}
			\caption{ }
		\end{subfigure}
		\caption{ \textbf{a)} Quadruped tipping about planted feet; \textbf{b)} Trot-gait sequence being executed by robot in \textbf{(a)}.}
		\label{fig::quadruped_walking}
	\end{figure}
Disturbance rejection from the trunk sub-system of a legged platform has practical significance when carrying a payload (such as cameras, optical systems, armaments, etc.) rigidly fixed to their main body. Disturbances are imparted upon the trunk during gaiting in two main ways: 1) instantaneous changes in force distribution when feet make and break contact with the ground, and 2) under-actuation that occurs during certain dynamic gaits. During dynamic gaits, such as trot gaits, the state of contact between the feet and the ground is changed often so as to prevent the walking robot from tipping past a recoverable configuration. Additionally, these gaits feature the utilization of two or fewer legs to support the trunk at any given time, causing the system to enter an under-actuated state where the body is free to rock about the planted feet, as shown in Figure \ref{fig::quadruped_walking}.

To achieve disturbance rejection on the trunk orientation and to attain a fixed orientation, the proposed control methodology utilizes a Nonlinear Autoregressive Neural Network with Exogenous inputs (NARX-NN) as part of an active compensation mechanism. The network is used to estimate the system dynamics and, further, predict periodic disturbances in an on-line fashion. To present how the NARX-NN based controller is formulated, we will first examine the general-form dynamics of a quadruped system. Next, the NARX-NN compensator mechanism will be outlined along with an associated NARX-NN training regimen formulated with respect to the system dynamics. The compensator will then be formulated for use with a legged system implemented with a decentralized joint control architecture. Here, the compensator will be utilized to modify referential joint trajectories by way of a weighted sum between the original joint trajectories generated by the gaiting mechanism and a reference correction signal generated by the compensator.

The effectiveness of the proposed methodology for gait modification to achieve a stable trunk will be shown through extensive simulation studies on a quadruped robot modeled after our in-house developed quadruped system (the BlueFoot Quadruped) during a CPG-driven trot gait. Results will highlight the robustness of the compensator during gaits at various speeds. We also include results which depict the effect various mixtures between the original CPG reference and NARX-NN compensator output signals. Lastly, some final remarks will be made about possible directions for enhancing the design of the controller at hand.